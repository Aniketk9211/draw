define("tiny_draw/commands",["exports","editor_tiny/utils","./common","core/config"],(function(_exports,_utils,_common,_config){var obj;
/**
   * Commands helper for the Moodle tiny_draw plugin.
   *
   * @module      plugintype_pluginname/commands
   * @copyright   2024 Aniket Kumar <aniketkj9211@gmail.com>
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */function loadScript(url){return new Promise(((resolve,reject)=>{var script=document.createElement("script");script.type="text/javascript",script.src=url,script.onload=()=>{console.log(`Successfully loaded: ${url}`),resolve()},script.onerror=()=>{console.error(`Failed to load script: ${url}`),reject(new Error(`Failed to load script: ${url}`))},document.body.appendChild(script)}))}function loadCSS(url){return new Promise(((resolve,reject)=>{var link=document.createElement("link");link.rel="stylesheet",link.href=url,link.onload=resolve,link.onerror=reject,document.head.appendChild(link)}))}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.getSetup=void 0,_config=(obj=_config)&&obj.__esModule?obj:{default:obj};const openChemDoodleModal=editor=>{editor.windowManager.open({title:"Draw Chemical Structure",body:{type:"panel",items:[{type:"htmlpanel",html:'<div id="chemdoodle-draw" style="width: 800px; height: 400px;"></div>'}]},buttons:[{type:"cancel",text:"Close"},{type:"submit",text:"Insert",primary:!0}],onSubmit:function(api){((editor,sketcher)=>{let imageData=sketcher.canvas.toDataURL("image/png");editor.insertContent(`<img src="${imageData}" />`)})(editor),api.close()},onPostRender:function(){new ChemDoodle.SketcherCanvas(800,300,"chemdoodle-draw",{useServices:!0}).repaint()}})},handleAction=editor=>{"undefined"==typeof ChemDoodle?async function(){try{await loadScript(`${_config.default.wwwroot}/lib/editor/tiny/plugins/draw/lib/ChemDoodle/install/ChemDoodleWeb.js`),await loadCSS(`${_config.default.wwwroot}/lib/editor/tiny/plugins/draw/lib/ChemDoodle/install/ChemDoodleWeb.css`),await loadCSS(`${_config.default.wwwroot}/lib/editor/tiny/plugins/draw/lib/ChemDoodle/install/is/jquery-ui-1.11.4.css`),await new Promise((resolve=>setTimeout(resolve,1e3))),await loadScript(`${_config.default.wwwroot}/lib/editor/tiny/plugins/draw/lib/ChemDoodle/install/is/ChemDoodleWeb-uis.js`),console.log("All ChemDoodle components loaded successfully")}catch(error){console.error("Failed to load ChemDoodle components:",error)}}():openChemDoodleModal(editor)};_exports.getSetup=async()=>{const buttonImage=await(0,_utils.getButtonImage)("icon",_common.component);return editor=>{editor.ui.registry.addIcon(_common.icon,buttonImage.html),editor.ui.registry.addButton(_common.buttonName,{tooltip:_common.buttonName,icon:_common.icon,onAction:()=>handleAction(editor)}),editor.ui.registry.addMenuItem(_common.buttonName,{icon:_common.icon,text:_common.buttonName,context:"tools",onAction:()=>handleAction(editor)})}}}));

//# sourceMappingURL=commands.min.js.map